{"remainingRequest":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\src\\components\\content\\productshow.vue?vue&type=style&index=0&id=3318def6&scoped=true&lang=scss&","dependencies":[{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\src\\components\\content\\productshow.vue","mtime":1595128050241},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\sass-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KQGltcG9ydCAnfmFzc2V0cy9jc3MvcHJvZHVjdHNob3cvbGlmZS5zY3NzJzsNCg=="},{"version":3,"sources":["productshow.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwMA","file":"productshow.vue","sourceRoot":"src/components/content","sourcesContent":["<template>\r\n  <fragment>\r\n    <div class=\"lifeapp\" v-if=\"$store.state.showbox.showlist.length > 0 && this.listpro != null\">\r\n      <div class=\"sort\">\r\n        <ul>\r\n          <li style=\"font-weight:bold;text-decoration:none;cursor: unset\">排序方式：</li>\r\n          <li>\r\n            <a href=\"javascript:;\" @click=\"sort('CreateDate')\">\r\n              最新\r\n              <span v-if=\"sortByObject['CreateDate'] === 'asc'\" class=\"icon iconfont\">&#xe6db;</span>\r\n              <span v-if=\"sortByObject['CreateDate'] === 'desc'\" class=\"icon iconfont\">&#xe6da;</span>\r\n            </a>\r\n          </li>\r\n          <li>\r\n            <a href=\"javascript:;\" @click=\"sort('Score')\">\r\n              销量\r\n              <span v-if=\"sortByObject['Score'] === 'asc'\" class=\"icon iconfont\">&#xe6db;</span>\r\n              <span v-if=\"sortByObject['Score'] === 'desc'\" class=\"icon iconfont\">&#xe6da;</span>\r\n            </a>\r\n          </li>\r\n          <li>\r\n            <a href=\"javascript:;\" @click=\"sort('Price')\">\r\n              价格\r\n              <span v-if=\"sortByObject['Price'] === 'asc'\" class=\"icon iconfont\">&#xe6db;</span>\r\n              <span v-if=\"sortByObject['Price'] === 'desc'\" class=\"icon iconfont\">&#xe6da;</span>\r\n            </a>\r\n            <!-- <span class=\"icon iconfont\">&#xe6db;</span> -->\r\n          </li>\r\n          <!-- <li>\r\n            <a href=\"javascript:;\" @click=\"sort(4)\">价格</a>\r\n            <span class=\"icon iconfont\">&#xe6da;</span>\r\n          </li>-->\r\n        </ul>\r\n      </div>\r\n      <ul class=\"products\" v-if=\"listpro.length > 0\">\r\n        <li v-for=\"item in listpro\" :key=\"item.id\">\r\n          <showbox\r\n            :imgSrc=\"item.children\"\r\n            :price=\"item.Price\"\r\n            :tittle=\"item.Pro_Name\"\r\n            :Pro_Id=\"item.Pro_Id\"\r\n          ></showbox>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"empty\" v-if=\"busy && !loadAll\">加载中...</div>\r\n    <div class=\"empty\" v-if=\"listpro.length > 0 && loadAll\">亲，没有更多了...</div>\r\n    <div class=\"empty\" v-if=\"listpro && listpro.length === 0\">暂无数据...</div>\r\n  </fragment>\r\n</template>\r\n\r\n<script>\r\n// import { formatNum } from '../../toolkit'\r\nimport { mapGetters, mapActions } from 'vuex'\r\nimport breadcrumbVue from '@/components/content/breadcrumb'\r\nimport showbox from './showbox'\r\nexport default {\r\n  name: 'lifeapp',\r\n  data() {\r\n    return {\r\n      sortby: 'CreateDate_desc',\r\n      listpro: [],\r\n      // type: \"\",\r\n      loadAll: false,\r\n      orderby: 'desc',\r\n      busy: false,\r\n      sortName: 'CreateDate',\r\n      currentPage: 0\r\n      // root: 0,\r\n      // size: 0,\r\n      // type: 0\r\n      // key: ''\r\n    }\r\n  },\r\n  props: ['productType'],\r\n  components: {\r\n    breadcrumbVue,\r\n    showbox\r\n  },\r\n  created: async function() {\r\n    this.getprolist()\r\n    window.addEventListener('scroll', this.scroll)\r\n  },\r\n  destroyed() {\r\n    window.removeEventListener('scroll', this.scroll)\r\n  },\r\n  methods: {\r\n    ...mapActions(['getshowlist']),\r\n    scroll: function(a) {\r\n      const body = document.body\r\n      const viewportHeight = body.offsetHeight\r\n      const scrollTop = body.scrollTop\r\n      if (\r\n        scrollTop + window.innerHeight + 100 >= viewportHeight &&\r\n        !this.busy\r\n      ) {\r\n        this.getprolist()\r\n      }\r\n    },\r\n    getprolist: function(currentPage) {\r\n      if (currentPage) {\r\n        this.currentPage = currentPage\r\n      } else {\r\n        this.currentPage += 1\r\n      }\r\n      // if (this.currentPage > this.totalSize) {\r\n      //   return;\r\n      // }\r\n\r\n      console.log(this.currentPage)\r\n      let data = {\r\n        PageCount: 20,\r\n        CurrentPage: this.currentPage,\r\n        key: this.key,\r\n        orderby: this.orderby, //排序方式\r\n        sortName: this.sortName, //排序字段\r\n        root: this.root, //根数\r\n        size: this.size, //尺寸\r\n        type: this.type, //类型\r\n        P_Type_Menu_Id: this.$store.state.shopmenustore.navbar\r\n      }\r\n      this.busy = true\r\n\r\n      const done = this.getshowlist(data)\r\n        .then(result => {\r\n          this.listpro =\r\n            this.currentPage !== 1\r\n              ? this.listpro.concat(this.showlist || [])\r\n              : this.showlist\r\n        })\r\n        .finally(() => {\r\n          if (this.totalSize <= this.currentPage) {\r\n            console.log('到底了')\r\n            this.loadAll = true\r\n            return\r\n          }\r\n          this.busy = false\r\n        })\r\n    },\r\n    //排序\r\n    sort(key) {\r\n      const sortBySplit = this.sortby.split('_')\r\n      const currentKey = sortBySplit[0]\r\n      const currentSortBy = sortBySplit[1]\r\n      let sortBy = 'desc'\r\n      if (key === currentKey) {\r\n        if (currentSortBy === 'desc') {\r\n          sortBy = 'asc'\r\n        }\r\n        if (currentSortBy === 'asc') {\r\n          sortBy = 'desc'\r\n        }\r\n      }\r\n      this.orderby = sortBy\r\n      this.sortName = key\r\n      this.sortby = `${key}_${sortBy}`\r\n    },\r\n    watchList: async function() {\r\n      this.getprolist(1)\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['showlist', 'key', 'root', 'size', 'type', 'totalSize']),\r\n    sortByObject() {\r\n      const sortBySplit = this.sortby.split('_')\r\n      return {\r\n        [sortBySplit[0]]: sortBySplit[1]\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    '$store.state.showbox.key': function() {\r\n      //监听vuex中userName变化而改变header里面的值\r\n      this.watchList()\r\n    },\r\n    '$store.state.showbox.root': function() {\r\n      //监听vuex中userName变化而改变header里面的值\r\n      console.log('watch root')\r\n      this.watchList()\r\n    },\r\n    '$store.state.showbox.size': function() {\r\n      //监听vuex中userName变化而改变header里面的值\r\n      console.log('watch size')\r\n      this.watchList()\r\n    },\r\n    '$store.state.showbox.type': function() {\r\n      //监听vuex中userName变化而改变header里面的值\r\n      console.log('watch type')\r\n      this.watchList()\r\n    },\r\n    orderby: function() {\r\n      this.watchList()\r\n    },\r\n    sortName: function() {\r\n      this.watchList()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped lang=\"scss\">\r\n@import '~assets/css/productshow/life.scss';\r\n</style>\r\n"]}]}