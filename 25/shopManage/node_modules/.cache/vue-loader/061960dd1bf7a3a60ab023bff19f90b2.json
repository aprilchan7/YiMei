{"remainingRequest":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\src\\components\\content\\productshow.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\src\\components\\content\\productshow.vue","mtime":1595302458576},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\FE_LEARNING_SPACE\\workmanage\\four\\shopmanage\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQovLyBpbXBvcnQgeyBmb3JtYXROdW0gfSBmcm9tICcuLi8uLi90b29sa2l0Jw0KaW1wb3J0IHsgbWFwR2V0dGVycywgbWFwQWN0aW9ucyB9IGZyb20gJ3Z1ZXgnDQppbXBvcnQgYnJlYWRjcnVtYlZ1ZSBmcm9tICdAL2NvbXBvbmVudHMvY29udGVudC9icmVhZGNydW1iJw0KaW1wb3J0IHNob3dib3ggZnJvbSAnLi9zaG93Ym94Jw0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAnbGlmZWFwcCcsDQogIGRhdGEoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIHNvcnRieTogJ0NyZWF0ZURhdGVfZGVzYycsDQogICAgICBsaXN0cHJvOiBbXSwNCiAgICAgIC8vIHR5cGU6ICIiLA0KICAgICAgbG9hZEFsbDogZmFsc2UsDQogICAgICBvcmRlcmJ5OiAnZGVzYycsDQogICAgICBidXN5OiBmYWxzZSwNCiAgICAgIHNvcnROYW1lOiAnQ3JlYXRlRGF0ZScsDQogICAgICBjdXJyZW50UGFnZTogMA0KICAgICAgLy8gcm9vdDogMCwNCiAgICAgIC8vIHNpemU6IDAsDQogICAgICAvLyB0eXBlOiAwDQogICAgICAvLyBrZXk6ICcnDQogICAgfQ0KICB9LA0KICBwcm9wczogWydwcm9kdWN0VHlwZSddLA0KICBjb21wb25lbnRzOiB7DQogICAgYnJlYWRjcnVtYlZ1ZSwNCiAgICBzaG93Ym94DQogIH0sDQogIGNyZWF0ZWQ6IGFzeW5jIGZ1bmN0aW9uKCkgew0KICAgIHRoaXMuZ2V0cHJvbGlzdCgpDQogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuc2Nyb2xsKQ0KICB9LA0KICBkZXN0cm95ZWQoKSB7DQogICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHRoaXMuc2Nyb2xsKQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgLi4ubWFwQWN0aW9ucyhbJ2dldHNob3dsaXN0J10pLA0KICAgIHNjcm9sbDogZnVuY3Rpb24oYSkgew0KICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LmJvZHkNCiAgICAgIC8vIGNvbnN0IHZpZXdwb3J0SGVpZ2h0ID0gYm9keS5vZmZzZXRIZWlnaHQNCiAgICAgIC8vIGNvbnN0IHNjcm9sbFRvcCA9IGJvZHkuc2Nyb2xsVG9wDQogICAgICAvLyBjb25zb2xlLmxvZyhzY3JvbGxUb3AgKyB3aW5kb3cuaW5uZXJIZWlnaHQsIHZpZXdwb3J0SGVpZ2h0LCB0aGlzLmJ1c3kpDQogICAgICAvLyBpZiAoc2Nyb2xsVG9wICsgd2luZG93LmlubmVySGVpZ2h0KzMwMCA+PSB2aWV3cG9ydEhlaWdodCAmJiAhdGhpcy5idXN5KSB7DQogICAgICAvLyAgIGNvbnNvbGUubG9nKCczMzMzMzMzMzMzMzMnKQ0KICAgICAgLy8gICB0aGlzLmdldHByb2xpc3QoKQ0KICAgICAgLy8gfQ0KICAgICAgY29uc3Qgdmlld3BvcnRIZWlnaHQgPSBib2R5Lm9mZnNldEhlaWdodA0KICAgICAgY29uc3Qgc2Nyb2xsVG9wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcA0KICAgICAgLy8gY29uc29sZS5sb2coc2Nyb2xsVG9wLCB3aW5kb3cuaW5uZXJIZWlnaHQsIHZpZXdwb3J0SGVpZ2h0LCB0aGlzLmJ1c3kpDQogICAgICBpZiAoc2Nyb2xsVG9wICsgd2luZG93LmlubmVySGVpZ2h0ID49IHZpZXdwb3J0SGVpZ2h0ICYmICF0aGlzLmJ1c3kpIHsNCiAgICAgICAgdGhpcy5nZXRwcm9saXN0KCkNCiAgICAgIH0NCiAgICB9LA0KICAgIGdldHByb2xpc3Q6IGZ1bmN0aW9uKGN1cnJlbnRQYWdlKSB7DQogICAgICBpZiAoY3VycmVudFBhZ2UpIHsNCiAgICAgICAgdGhpcy5jdXJyZW50UGFnZSA9IGN1cnJlbnRQYWdlDQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmN1cnJlbnRQYWdlICs9IDENCiAgICAgIH0NCiAgICAgIC8vIGlmICh0aGlzLmN1cnJlbnRQYWdlID4gdGhpcy50b3RhbFNpemUpIHsNCiAgICAgIC8vICAgcmV0dXJuOw0KICAgICAgLy8gfQ0KDQogICAgICBjb25zb2xlLmxvZyh0aGlzLmN1cnJlbnRQYWdlKQ0KICAgICAgbGV0IGRhdGEgPSB7DQogICAgICAgIFBhZ2VDb3VudDogMjAsDQogICAgICAgIEN1cnJlbnRQYWdlOiB0aGlzLmN1cnJlbnRQYWdlLA0KICAgICAgICBrZXk6IHRoaXMua2V5LA0KICAgICAgICBvcmRlcmJ5OiB0aGlzLm9yZGVyYnksIC8v5o6S5bqP5pa55byPDQogICAgICAgIHNvcnROYW1lOiB0aGlzLnNvcnROYW1lLCAvL+aOkuW6j+Wtl+autQ0KICAgICAgICByb290OiB0aGlzLnJvb3QsIC8v5qC55pWwDQogICAgICAgIHNpemU6IHRoaXMuc2l6ZSwgLy/lsLrlr7gNCiAgICAgICAgdHlwZTogdGhpcy50eXBlLCAvL+exu+Weiw0KICAgICAgICBQX1R5cGVfTWVudV9JZDogdGhpcy4kc3RvcmUuc3RhdGUuc2hvcG1lbnVzdG9yZS5uYXZiYXINCiAgICAgIH0NCiAgICAgIHRoaXMuYnVzeSA9IHRydWUNCg0KICAgICAgY29uc3QgZG9uZSA9IHRoaXMuZ2V0c2hvd2xpc3QoZGF0YSkNCiAgICAgICAgLnRoZW4ocmVzdWx0ID0+IHsNCiAgICAgICAgICB0aGlzLmxpc3Rwcm8gPQ0KICAgICAgICAgICAgdGhpcy5jdXJyZW50UGFnZSAhPT0gMQ0KICAgICAgICAgICAgICA/IHRoaXMubGlzdHByby5jb25jYXQodGhpcy5zaG93bGlzdCB8fCBbXSkNCiAgICAgICAgICAgICAgOiB0aGlzLnNob3dsaXN0DQogICAgICAgIH0pDQogICAgICAgIC5maW5hbGx5KCgpID0+IHsNCiAgICAgICAgICBpZiAodGhpcy50b3RhbFNpemUgPD0gdGhpcy5jdXJyZW50UGFnZSkgew0KICAgICAgICAgICAgY29uc29sZS5sb2coJ+WIsOW6leS6hicpDQogICAgICAgICAgICB0aGlzLmxvYWRBbGwgPSB0cnVlDQogICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICB9DQogICAgICAgICAgdGhpcy5idXN5ID0gZmFsc2UNCiAgICAgICAgfSkNCiAgICB9LA0KICAgIC8v5o6S5bqPDQogICAgc29ydChrZXkpIHsNCiAgICAgIGNvbnN0IHNvcnRCeVNwbGl0ID0gdGhpcy5zb3J0Ynkuc3BsaXQoJ18nKQ0KICAgICAgY29uc3QgY3VycmVudEtleSA9IHNvcnRCeVNwbGl0WzBdDQogICAgICBjb25zdCBjdXJyZW50U29ydEJ5ID0gc29ydEJ5U3BsaXRbMV0NCiAgICAgIGxldCBzb3J0QnkgPSAnZGVzYycNCiAgICAgIGlmIChrZXkgPT09IGN1cnJlbnRLZXkpIHsNCiAgICAgICAgaWYgKGN1cnJlbnRTb3J0QnkgPT09ICdkZXNjJykgew0KICAgICAgICAgIHNvcnRCeSA9ICdhc2MnDQogICAgICAgIH0NCiAgICAgICAgaWYgKGN1cnJlbnRTb3J0QnkgPT09ICdhc2MnKSB7DQogICAgICAgICAgc29ydEJ5ID0gJ2Rlc2MnDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHRoaXMub3JkZXJieSA9IHNvcnRCeQ0KICAgICAgdGhpcy5zb3J0TmFtZSA9IGtleQ0KICAgICAgdGhpcy5zb3J0YnkgPSBgJHtrZXl9XyR7c29ydEJ5fWANCiAgICB9LA0KICAgIHdhdGNoTGlzdDogYXN5bmMgZnVuY3Rpb24oKSB7DQogICAgICB0aGlzLmdldHByb2xpc3QoMSkNCiAgICB9DQogIH0sDQogIGNvbXB1dGVkOiB7DQogICAgLi4ubWFwR2V0dGVycyhbJ3Nob3dsaXN0JywgJ2tleScsICdyb290JywgJ3NpemUnLCAndHlwZScsICd0b3RhbFNpemUnXSksDQogICAgc29ydEJ5T2JqZWN0KCkgew0KICAgICAgY29uc3Qgc29ydEJ5U3BsaXQgPSB0aGlzLnNvcnRieS5zcGxpdCgnXycpDQogICAgICByZXR1cm4gew0KICAgICAgICBbc29ydEJ5U3BsaXRbMF1dOiBzb3J0QnlTcGxpdFsxXQ0KICAgICAgfQ0KICAgIH0NCiAgfSwNCiAgd2F0Y2g6IHsNCiAgICAnJHN0b3JlLnN0YXRlLnNob3dib3gua2V5JzogZnVuY3Rpb24oKSB7DQogICAgICAvL+ebkeWQrHZ1ZXjkuK11c2VyTmFtZeWPmOWMluiAjOaUueWPmGhlYWRlcumHjOmdoueahOWAvA0KICAgICAgdGhpcy53YXRjaExpc3QoKQ0KICAgIH0sDQogICAgJyRzdG9yZS5zdGF0ZS5zaG93Ym94LnJvb3QnOiBmdW5jdGlvbigpIHsNCiAgICAgIC8v55uR5ZCsdnVleOS4rXVzZXJOYW1l5Y+Y5YyW6ICM5pS55Y+YaGVhZGVy6YeM6Z2i55qE5YC8DQogICAgICBjb25zb2xlLmxvZygnd2F0Y2ggcm9vdCcpDQogICAgICB0aGlzLndhdGNoTGlzdCgpDQogICAgfSwNCiAgICAnJHN0b3JlLnN0YXRlLnNob3dib3guc2l6ZSc6IGZ1bmN0aW9uKCkgew0KICAgICAgLy/nm5HlkKx2dWV45LitdXNlck5hbWXlj5jljJbogIzmlLnlj5hoZWFkZXLph4zpnaLnmoTlgLwNCiAgICAgIGNvbnNvbGUubG9nKCd3YXRjaCBzaXplJykNCiAgICAgIHRoaXMud2F0Y2hMaXN0KCkNCiAgICB9LA0KICAgICckc3RvcmUuc3RhdGUuc2hvd2JveC50eXBlJzogZnVuY3Rpb24oKSB7DQogICAgICAvL+ebkeWQrHZ1ZXjkuK11c2VyTmFtZeWPmOWMluiAjOaUueWPmGhlYWRlcumHjOmdoueahOWAvA0KICAgICAgY29uc29sZS5sb2coJ3dhdGNoIHR5cGUnKQ0KICAgICAgdGhpcy53YXRjaExpc3QoKQ0KICAgIH0sDQogICAgb3JkZXJieTogZnVuY3Rpb24oKSB7DQogICAgICB0aGlzLndhdGNoTGlzdCgpDQogICAgfSwNCiAgICBzb3J0TmFtZTogZnVuY3Rpb24oKSB7DQogICAgICB0aGlzLndhdGNoTGlzdCgpDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["productshow.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"productshow.vue","sourceRoot":"src/components/content","sourcesContent":["<template>\r\n  <fragment>\r\n    <div class=\"lifeapp\" v-if=\"$store.state.showbox.showlist.length > 0 && this.listpro != null\">\r\n      <div class=\"sort\">\r\n        <ul>\r\n          <li style=\"font-weight:bold;text-decoration:none;cursor: unset\">排序方式：</li>\r\n          <li>\r\n            <a href=\"javascript:;\" @click=\"sort('CreateDate')\">\r\n              最新\r\n              <span v-if=\"sortByObject['CreateDate'] === 'asc'\" class=\"icon iconfont\">&#xe6db;</span>\r\n              <span v-if=\"sortByObject['CreateDate'] === 'desc'\" class=\"icon iconfont\">&#xe6da;</span>\r\n            </a>\r\n          </li>\r\n          <li>\r\n            <a href=\"javascript:;\" @click=\"sort('Score')\">\r\n              销量\r\n              <span v-if=\"sortByObject['Score'] === 'asc'\" class=\"icon iconfont\">&#xe6db;</span>\r\n              <span v-if=\"sortByObject['Score'] === 'desc'\" class=\"icon iconfont\">&#xe6da;</span>\r\n            </a>\r\n          </li>\r\n          <li>\r\n            <a href=\"javascript:;\" @click=\"sort('Price')\">\r\n              价格\r\n              <span v-if=\"sortByObject['Price'] === 'asc'\" class=\"icon iconfont\">&#xe6db;</span>\r\n              <span v-if=\"sortByObject['Price'] === 'desc'\" class=\"icon iconfont\">&#xe6da;</span>\r\n            </a>\r\n            <!-- <span class=\"icon iconfont\">&#xe6db;</span> -->\r\n          </li>\r\n          <!-- <li>\r\n            <a href=\"javascript:;\" @click=\"sort(4)\">价格</a>\r\n            <span class=\"icon iconfont\">&#xe6da;</span>\r\n          </li>-->\r\n        </ul>\r\n      </div>\r\n      <ul class=\"products\" v-if=\"listpro.length > 0\">\r\n        <li v-for=\"item in listpro\" :key=\"item.id\" class=\"items\">\r\n          <showbox\r\n            :imgSrc=\"item.children\"\r\n            :price=\"item.Price\"\r\n            :tittle=\"item.Pro_Name\"\r\n            :Pro_Id=\"item.Pro_Id\"\r\n            :Tag_Type=\"item.Tag_Type\"\r\n          ></showbox>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n    <div class=\"empty\" v-if=\"busy && !loadAll\">加载中...</div>\r\n    <div class=\"empty\" v-if=\"listpro.length > 0 && loadAll\">亲，没有更多了...</div>\r\n    <div class=\"empty\" v-if=\"listpro && listpro.length === 0\">暂无数据...</div>\r\n  </fragment>\r\n</template>\r\n\r\n<script>\r\n// import { formatNum } from '../../toolkit'\r\nimport { mapGetters, mapActions } from 'vuex'\r\nimport breadcrumbVue from '@/components/content/breadcrumb'\r\nimport showbox from './showbox'\r\nexport default {\r\n  name: 'lifeapp',\r\n  data() {\r\n    return {\r\n      sortby: 'CreateDate_desc',\r\n      listpro: [],\r\n      // type: \"\",\r\n      loadAll: false,\r\n      orderby: 'desc',\r\n      busy: false,\r\n      sortName: 'CreateDate',\r\n      currentPage: 0\r\n      // root: 0,\r\n      // size: 0,\r\n      // type: 0\r\n      // key: ''\r\n    }\r\n  },\r\n  props: ['productType'],\r\n  components: {\r\n    breadcrumbVue,\r\n    showbox\r\n  },\r\n  created: async function() {\r\n    this.getprolist()\r\n    window.addEventListener('scroll', this.scroll)\r\n  },\r\n  destroyed() {\r\n    window.removeEventListener('scroll', this.scroll)\r\n  },\r\n  methods: {\r\n    ...mapActions(['getshowlist']),\r\n    scroll: function(a) {\r\n      const body = document.body\r\n      // const viewportHeight = body.offsetHeight\r\n      // const scrollTop = body.scrollTop\r\n      // console.log(scrollTop + window.innerHeight, viewportHeight, this.busy)\r\n      // if (scrollTop + window.innerHeight+300 >= viewportHeight && !this.busy) {\r\n      //   console.log('333333333333')\r\n      //   this.getprolist()\r\n      // }\r\n      const viewportHeight = body.offsetHeight\r\n      const scrollTop = document.documentElement.scrollTop\r\n      // console.log(scrollTop, window.innerHeight, viewportHeight, this.busy)\r\n      if (scrollTop + window.innerHeight >= viewportHeight && !this.busy) {\r\n        this.getprolist()\r\n      }\r\n    },\r\n    getprolist: function(currentPage) {\r\n      if (currentPage) {\r\n        this.currentPage = currentPage\r\n      } else {\r\n        this.currentPage += 1\r\n      }\r\n      // if (this.currentPage > this.totalSize) {\r\n      //   return;\r\n      // }\r\n\r\n      console.log(this.currentPage)\r\n      let data = {\r\n        PageCount: 20,\r\n        CurrentPage: this.currentPage,\r\n        key: this.key,\r\n        orderby: this.orderby, //排序方式\r\n        sortName: this.sortName, //排序字段\r\n        root: this.root, //根数\r\n        size: this.size, //尺寸\r\n        type: this.type, //类型\r\n        P_Type_Menu_Id: this.$store.state.shopmenustore.navbar\r\n      }\r\n      this.busy = true\r\n\r\n      const done = this.getshowlist(data)\r\n        .then(result => {\r\n          this.listpro =\r\n            this.currentPage !== 1\r\n              ? this.listpro.concat(this.showlist || [])\r\n              : this.showlist\r\n        })\r\n        .finally(() => {\r\n          if (this.totalSize <= this.currentPage) {\r\n            console.log('到底了')\r\n            this.loadAll = true\r\n            return\r\n          }\r\n          this.busy = false\r\n        })\r\n    },\r\n    //排序\r\n    sort(key) {\r\n      const sortBySplit = this.sortby.split('_')\r\n      const currentKey = sortBySplit[0]\r\n      const currentSortBy = sortBySplit[1]\r\n      let sortBy = 'desc'\r\n      if (key === currentKey) {\r\n        if (currentSortBy === 'desc') {\r\n          sortBy = 'asc'\r\n        }\r\n        if (currentSortBy === 'asc') {\r\n          sortBy = 'desc'\r\n        }\r\n      }\r\n      this.orderby = sortBy\r\n      this.sortName = key\r\n      this.sortby = `${key}_${sortBy}`\r\n    },\r\n    watchList: async function() {\r\n      this.getprolist(1)\r\n    }\r\n  },\r\n  computed: {\r\n    ...mapGetters(['showlist', 'key', 'root', 'size', 'type', 'totalSize']),\r\n    sortByObject() {\r\n      const sortBySplit = this.sortby.split('_')\r\n      return {\r\n        [sortBySplit[0]]: sortBySplit[1]\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    '$store.state.showbox.key': function() {\r\n      //监听vuex中userName变化而改变header里面的值\r\n      this.watchList()\r\n    },\r\n    '$store.state.showbox.root': function() {\r\n      //监听vuex中userName变化而改变header里面的值\r\n      console.log('watch root')\r\n      this.watchList()\r\n    },\r\n    '$store.state.showbox.size': function() {\r\n      //监听vuex中userName变化而改变header里面的值\r\n      console.log('watch size')\r\n      this.watchList()\r\n    },\r\n    '$store.state.showbox.type': function() {\r\n      //监听vuex中userName变化而改变header里面的值\r\n      console.log('watch type')\r\n      this.watchList()\r\n    },\r\n    orderby: function() {\r\n      this.watchList()\r\n    },\r\n    sortName: function() {\r\n      this.watchList()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style scoped lang=\"scss\">\r\n@import '~assets/css/productshow/life.scss';\r\n</style>\r\n"]}]}